{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///C:/Proyectos/estratego-web/lib/supabase.ts"],"sourcesContent":["// lib/supabase.ts\r\nimport { createClient } from \"@supabase/supabase-js\";\r\n\r\n\r\nexport const supabase = createClient(\r\nprocess.env.NEXT_PUBLIC_SUPABASE_URL!,\r\nprocess.env.SUPABASE_SERVICE_ROLE_KEY || process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n\r\n\r\n// Tipos base (ajÃºstalos a tus tablas reales)\r\nexport type DbPlayer = { id: string; name: string; country?: string | null; seed?: number | null };\r\nexport type DbMatch = { id: string; round: 'R16'|'QF'|'SF'|'F'; top_id: string; bot_id: string };\r\nexport type DbDraw = { tournament_id: string; event: string; surface: string; draw_size: number };"],"names":[],"mappings":"AAAA,kBAAkB;;;;;AAClB;;AAGO,MAAM,WAAW,IAAA,yMAAY,gFAEpC,QAAQ,GAAG,CAAC,yBAAyB","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Proyectos/estratego-web/app/api/simulate/route.ts"],"sourcesContent":["// app/api/simulate/route.ts\r\nexport const dynamic = \"force-dynamic\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\n\r\ntype Player = { id: string; name: string; seed?: number; country?: string };\r\n\r\n\r\ntype Match = { id: string; round: 'R16'|'QF'|'SF'|'F'; top: Player; bottom: Player; winnerId?: string };\r\n\r\n\r\ntype Bracket = { tournamentId: string; event: string; surface: string; drawSize: number; matches: Match[] };\r\n\r\n\r\nfunction nextRound(r: Match['round']): Match['round'] { return r==='R16'?'QF':r==='QF'?'SF':r==='SF'?'F':'F'; }\r\n\r\n\r\nfunction simulate(bracket: Bracket): Bracket {\r\nconst rnd = (n: number) => Math.floor(Math.random() * n);\r\nconst copy: Bracket = JSON.parse(JSON.stringify(bracket));\r\nconst rounds: Match['round'][] = ['R16','QF','SF','F'];\r\nfor (const round of rounds) {\r\nconst ms = copy.matches.filter(m => m.round === round).sort((a,b)=>a.id.localeCompare(b.id));\r\nfor (const m of ms) {\r\nconst favBias = (m.top.seed ?? 99) < (m.bottom.seed ?? 99) ? 58 : 42;\r\nconst coin = rnd(100);\r\nconst win = coin < favBias ? m.top : m.bottom;\r\nm.winnerId = win.id;\r\n}\r\nif (round !== 'F') {\r\nconst winners = ms.map(m => (m.winnerId === m.top.id ? m.top : m.bottom));\r\nconst next: Match[] = [];\r\nfor (let i=0;i<winners.length;i+=2) {\r\nnext.push({ id: `${nextRound(round)}-${Math.floor(i/2)+1}`, round: nextRound(round), top: winners[i], bottom: winners[i+1] });\r\n}\r\ncopy.matches = copy.matches.filter(m => m.round !== nextRound(round)).concat(next);\r\n}\r\n}\r\nreturn copy;\r\n}\r\n\r\n\r\nexport async function POST(req: Request) {\r\n  const { tourney_id } = await req.json();\r\n\r\n  if (!tourney_id) {\r\n    return new Response(JSON.stringify({ error: \"Missing tourney_id\" }), { status: 400 });\r\n  }\r\n\r\n  const { error } = await supabase.rpc(\"simulate_next_round\", { tourney_id });\r\n\r\n  if (error) {\r\n    return new Response(JSON.stringify({ error: error.message }), { status: 500 });\r\n  }\r\n\r\n  return new Response(JSON.stringify({ ok: true }), { status: 200 });\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;;AAE5B;AADO,MAAM,UAAU;;AAavB,SAAS,UAAU,CAAiB;IAAoB,OAAO,MAAI,QAAM,OAAK,MAAI,OAAK,OAAK,MAAI,OAAK,MAAI;AAAK;AAG9G,SAAS,SAAS,OAAgB;IAClC,MAAM,MAAM,CAAC,IAAc,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK;IACtD,MAAM,OAAgB,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC;IAChD,MAAM,SAA2B;QAAC;QAAM;QAAK;QAAK;KAAI;IACtD,KAAK,MAAM,SAAS,OAAQ;QAC5B,MAAM,KAAK,KAAK,OAAO,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,OAAO,IAAI,CAAC,CAAC,GAAE,IAAI,EAAE,EAAE,CAAC,aAAa,CAAC,EAAE,EAAE;QAC1F,KAAK,MAAM,KAAK,GAAI;YACpB,MAAM,UAAU,CAAC,EAAE,GAAG,CAAC,IAAI,IAAI,EAAE,IAAI,CAAC,EAAE,MAAM,CAAC,IAAI,IAAI,EAAE,IAAI,KAAK;YAClE,MAAM,OAAO,IAAI;YACjB,MAAM,MAAM,OAAO,UAAU,EAAE,GAAG,GAAG,EAAE,MAAM;YAC7C,EAAE,QAAQ,GAAG,IAAI,EAAE;QACnB;QACA,IAAI,UAAU,KAAK;YACnB,MAAM,UAAU,GAAG,GAAG,CAAC,CAAA,IAAM,EAAE,QAAQ,KAAK,EAAE,GAAG,CAAC,EAAE,GAAG,EAAE,GAAG,GAAG,EAAE,MAAM;YACvE,MAAM,OAAgB,EAAE;YACxB,IAAK,IAAI,IAAE,GAAE,IAAE,QAAQ,MAAM,EAAC,KAAG,EAAG;gBACpC,KAAK,IAAI,CAAC;oBAAE,IAAI,GAAG,UAAU,OAAO,CAAC,EAAE,KAAK,KAAK,CAAC,IAAE,KAAG,GAAG;oBAAE,OAAO,UAAU;oBAAQ,KAAK,OAAO,CAAC,EAAE;oBAAE,QAAQ,OAAO,CAAC,IAAE,EAAE;gBAAC;YAC3H;YACA,KAAK,OAAO,GAAG,KAAK,OAAO,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,UAAU,QAAQ,MAAM,CAAC;QAC7E;IACA;IACA,OAAO;AACP;AAGO,eAAe,KAAK,GAAY;IACrC,MAAM,EAAE,UAAU,EAAE,GAAG,MAAM,IAAI,IAAI;IAErC,IAAI,CAAC,YAAY;QACf,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO;QAAqB,IAAI;YAAE,QAAQ;QAAI;IACrF;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,6HAAQ,CAAC,GAAG,CAAC,uBAAuB;QAAE;IAAW;IAEzE,IAAI,OAAO;QACT,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,IAAI;YAAE,QAAQ;QAAI;IAC9E;IAEA,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;QAAE,IAAI;IAAK,IAAI;QAAE,QAAQ;IAAI;AAClE","debugId":null}}]
}